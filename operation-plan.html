
<link href="lay/css/layui.css" rel="stylesheet"/>
<link href="css/jedate.css" rel="stylesheet" type="text/css">
<link href="css/out.css" rel="stylesheet" type="text/css">
<link href="css/operation.css" rel="stylesheet" type="text/css">
    
    <div class="content filemanage">
    	<p class="crumbs">您当前的位置：运维管理 &gt; <a href="javascript:;">运维计划</a></p>
      	 
         <!--运维计划-->
         <div class="operation-plan">
         	<p class="add-nav fs-14 c-f ta-l">运维计划</p>
            <form action="">
            	<div class="plan-box fs-12 c-6 ta-c">
                	<div class="plan-classify">
                    	<span class="plan-span d-ib">项目名称：</span>
                        <select class="js-select370 select-normal city" name="worktype2">
                            <option>请选择</option>
                            <option>请选择</option>
                        </select>
                    </div>
                    <div class="plan-classify">
                    	<span class="plan-span d-ib">客户名称：</span>
                        <input type="text" value="自动选择" class="genre fs-12 c-9 ta-c" readonly>
                        &nbsp&nbsp&nbsp
                        <span class="plan-span d-ib">产品类型：</span>
                        <input type="text" value="自动选择" class="genre fs-12 c-9 ta-c" readonly>
                    </div>
                    <div class="plan-classify">
                    	<span class="plan-span d-ib">拟派运维人员：</span>
                        <p class="d-ib" id="staff">
                            <input type="text" value="李一一" readonly>
                        </p>
                        <a href="javascript:;" class="add-personnel d-ib ta-c">添加人员</a>
                    </div>
                    <div class="plan-classify">
                    	<span class="plan-span d-ib">运维类型：</span>
                        <div class="operation-type d-ib">
                            <label class="operation-label1"><span class="active d-ib ta-r c-9">故障运维</span><input name="Fruit" type="radio" value="" class="d-n" checked/></label>
                            <label class="operation-label2"><span class="d-ib ta-r c-9">例行运维</span><input name="Fruit" type="radio" value="" class="d-n"/></label>
                        </div>
                        <div class="batch d-n">
                        	<span>运维批次：</span>
                            <input type="text" value="2" class="batch-input limit-number fs-12 c-9 ta-c">
                        </div>
                    </div>
                    <div class="plan-classify">
                    	<span class="plan-span d-ib">计划开始时间：</span>
                        <input id="inpstart" name="time1" type="text" value="" placeholder="请选择" readonly>
                        &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
                        <span class="plan-span d-ib">计划结束时间：</span>
                        <input id="inpend" name="time1" type="text" value="" placeholder="请选择" readonly>
                    </div>
                    
                    <div class="plan-table">
                    	<div class="nodelist fs-12 c-f p-r">
                        	<span class="d-ib f-l">站点列表</span>
                            <a href="javascript:;" class="plussite-a d-ib ta-c f-r">添加运维站点</a>
                            <div class="c-b"></div>
                        </div>
                        <table cellspacing="1" cellpadding="0" class="fs-12 w">
                            <tbody>
                                <tr class="c-6">
                                    <th>序号</th>
                                    <th>站点名称</th>
                                    <th>操作</th>
                                </tr>
                                <tr class="c-9">
                                    <td>1</td>
                                    <td>站点名称站点名称站点名称站点名称</td>
                                    <td><a href="javascript:;" class="d-ib">删除</a></td>
                                </tr>
                                <tr class="c-9">
                                    <td>2</td>
                                    <td>站点名称站点名称站点名称站点名称</td>
                                    <td><a href="javascript:;" class="d-ib">删除</a></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <a href="javascript:;" class="add-submit d-ib ta-c fs-14">保存</a>
                </div>
            </form>
         </div>
    </div>
	
    <div class="mask p-f d-n"></div>
    <!--添加人员-->
    <div class="out-people bg-f p-f d-n" id="out-people">
    	<h5 class="fs-14 c-f ta-c">添加人员</h5>
        <div class="check-name">
        	<span class="f-l">人员菜单：</span>
            <span class="f-r">全选</span>
            <input type="checkbox" class="f-r d-n checkall" id="check-all">
            <label for="check-all" class="f-r"></label>
            <div class="c-b"></div>
        </div>
        <ul id="demo"></ul>
        <div class="opt ta-c fs-14 ta-c">
        	<a href="javascript:;" class="cancel d-ib" id="people-cancel">取消</a>
            <a href="javascript:;" class="keep d-ib" id="people-keep">保存</a>
        </div>
    </div>
    
    <!--添加运维站点-->
    <div class="plus-site bg-f p-f fs-12 c-6 d-n" id="plus-site">
    	<h5 class="fs-14 c-f ta-c">添加运维站点</h5>
        <p class="site-name">站点名称：&nbsp&nbsp&nbsp <input type="text" id="siteinput" value="新一代E区" readonly placeholder="请选择站点"></p>
        <div class="exist">
        	<span class="d-ib">已存在的站点：</span>
            <div class="all-check d-ib">
            	<label>
            		<input type="checkbox" class="checksite " id="check-site">
                    <i class="d-ib"></i>
                    <span>全选</span>
                </label>
            </div>
            <span class="selected-span d-ib">已选择站点<span id="number">0</span>个</span>
        </div>
        <div class="choose-site c-9">
        	<div class="choosebox d-ib">
            	<label>
            		<input type="checkbox" class="checksite " id="site1">
                    <i class="d-ib"></i>
                    <span>新一代E区</span>
                </label>
            </div>
            <div class="choosebox d-ib">
            	<label>
            		<input type="checkbox" class="checksite " id="site2">
                    <i class="d-ib"></i>
                    <span>新一代E区</span>
                </label>
            </div>
            <div class="choosebox d-ib">
                <label>
            		<input type="checkbox" class="checksite " id="site2">
                    <i class="d-ib"></i>
                    <span>新一代E区</span>
                </label>
            </div>
            <div class="choosebox d-ib">
                <label>
            		<input type="checkbox" class="checksite " id="site2">
                    <i class="d-ib"></i>
                    <span>新一代E区</span>
                </label>
            </div>
        </div>
        <div class="opt ta-c fs-14 ta-c">
        	<a href="javascript:;" class="cancel d-ib" id="site-cancel">取消</a>
            <a href="javascript:;" class="keep d-ib" id="site-keep">保存</a>
        </div>
    </div>
    
<script src="js/select2.js"></script>
<script src="js/select2_option.js"></script>
<script src="js/jquery.jedate.js"></script>
<script src="layui.js"></script>
<script>
	
	$(".operation-label1").click(function(){
		$(".batch").hide()
	})
	$(".operation-label2").click(function(){
		$(".batch").show()
	})
	
	
	$(".operation-type label").click(function(){
		var checkaone = $(".operation-type label").find("input").prop("checked");
		if( checkaone == true ){
			$(".operation-type label span").removeClass("active")
			$(this).find("span").addClass("active");
		}
	})
	//添加人员
	$(".add-personnel").click(function(){
		$(".mask,#out-people").show();
	})
	$(".plussite-a").click(function(){
		$(".mask,#plus-site").show();
	})
	$(".cancel,.keep").click(function(){
		$(".mask,#out-people,#plus-site").hide();
	})
	
	//添加运维站点
	$("#check-site").attr("checked",false);
	$(".choose-site").find(".choosebox input").attr("checked",false);
	$("#check-site").click(function(){
		var checksite = $("#check-site").prop("checked");
		if( checksite == true ){//选中
			$(".choose-site").find(".choosebox input").attr("checked",true);
		}
        if( checksite == false ){//未选中
            $(".choose-site").find(".choosebox input").attr("checked",false);
        }
        number()
	})
	$(".choose-site .choosebox label").click(function(){
		number()
	})
	$("#site-cancel").click(function(){
		$(".choose-site :checked").attr("checked",false)
		number()
	})
	function number(){
		setTimeout(function(){
			var str =$(".choose-site :checked").parent("label").find("span").map(function(index,elem){
				return $(elem).text();
			}).get().join(",")
			$("#siteinput").val(str)
			var check_length = $(".choosebox").find("input:checked").length;
			$("#number").text(check_length);
			if(check_length == 0){
				$("#check-site").attr("checked",false)	
			}
		},100)
	}
	number()

	//实现日期选择联动
	var start = {
		format: 'YYYY-MM-DD',
		choosefun: function(elem,datas){
			end.minDate = datas; //开始日选好后，重置结束日的最小日期
			endDates();
		}
	};
	var end = {
		format: 'YYYY-MM-DD',
		choosefun: function(elem,datas){
			start.maxDate = datas; //将结束日的初始值设定为开始日的最大日期
		}
	};
	function endDates() {
		end.trigger = false;
		$("#inpend").jeDate(end);
	}
	$("#inpstart").jeDate(start);
	$("#inpend").jeDate(end);
</script>
<script>
	layui.use('tree', function() {
		var tree = layui.tree({
			elem: '#demo', //指定元素，生成的树放到哪个元素上
			check: 'checkbox', //勾选风格
			skin: 'as', //设定皮肤
			drag: true,//点击每一项时是否生成提示信息
			checkboxName: 'aa[]',//复选框的name属性值
			checkboxStyle: "",//设置复选框的样式，必须为字符串
			onchange: function (){//当当前input发生变化后所执行的回调
				var strchecked =$("#demo ul :checked").length;
				var str =$("#demo ul :checked").parent("li").find("a").find("cite").map(function(index,elem){
						return $(elem).text();
					}).get().join(",")
				$("#staff input").val(str);
				$("#staff").show();
				if(strchecked ==0){
					$("#staff").hide();
				}
			},
			nodes: [ //节点
				{
					name: '工程中心', //节点名称
					checkboxValue: 0,//复选框的值
					data: {//为元素添加额外数据，即在元素上添加data-xxx="yyy"，可选
						nodeName: "工程中心",
						alias: "changyong"
					},
					children: [{
						name: '李一1',
						checkboxValue: 1
					}, {
						name: '李一2',
						checkboxValue: 2
					}, {
						name: '李一3',
						checkboxValue: 3
					}]
				},{
					name: '产品中心', //节点名称
					checkboxValue: 0,//复选框的值
					data: {//为元素添加额外数据，即在元素上添加data-xxx="yyy"，可选
						nodeName: "工程中心",
						alias: "changyong"
					},
					children: [{
						name: '李一4',
						checkboxValue: 1
					}, {
						name: '李一5',
						checkboxValue: 2
					}, {
						name: '李一6',
						checkboxValue: 3
					}]
				},{
					name: '工程中心', //节点名称
					checkboxValue: 0,//复选框的值
					data: {//为元素添加额外数据，即在元素上添加data-xxx="yyy"，可选
						nodeName: "工程中心",
						alias: "changyong"
					},
					children: [{
						name: '李一7',
						checkboxValue: 1
					}, {
						name: '李一8',
						checkboxValue: 2
					}, {
						name: '李一9',
						checkboxValue: 3
					}]
				},{
					name: '产品中心', //节点名称
					checkboxValue: 0,//复选框的值
					data: {//为元素添加额外数据，即在元素上添加data-xxx="yyy"，可选
						nodeName: "工程中心",
						alias: "changyong"
					},
					children: [{
						name: '李一10',
						checkboxValue: 1
					}, {
						name: '李一11',
						checkboxValue: 2
					}, {
						name: '李一12',
						checkboxValue: 3
					}]
				},{
					name: '工程中心', //节点名称
					checkboxValue: 0,//复选框的值
					data: {//为元素添加额外数据，即在元素上添加data-xxx="yyy"，可选
						nodeName: "工程中心",
						alias: "changyong"
					},
					children: [{
						name: '李一13',
						checkboxValue: 1
					}, {
						name: '李一14',
						checkboxValue: 2
					}, {
						name: '李一15',
						checkboxValue: 3
					}]
				},{
					name: '产品中心', //节点名称
					checkboxValue: 0,//复选框的值
					spread: true, //是否是展开状态，true为展开状态
					checked: true,//复选框默认是否选中	
					data: {//为元素添加额外数据，即在元素上添加data-xxx="yyy"，可选
						nodeName: "工程中心",
						alias: "changyong"
					},
					children: [{
						name: '李一一',
						checkboxValue: 1
					}, {
						name: '李一二',
						checkboxValue: 2,
						checked: true  //复选框默认是否选中
					}, {
						name: '李一三',
						checkboxValue: 3
					}]
				},{
					name: '工程中心', //节点名称
					checkboxValue: 0,//复选框的值
					data: {//为元素添加额外数据，即在元素上添加data-xxx="yyy"，可选
						nodeName: "工程中心",
						alias: "changyong"
					},
					children: [{
						name: '李一一',
						checkboxValue: 1
					}, {
						name: '李一一',
						checkboxValue: 2
					}, {
						name: '李一一',
						checkboxValue: 3
					}]
				},{
					name: '产品中心', //节点名称
					checkboxValue: 0,//复选框的值
					data: {//为元素添加额外数据，即在元素上添加data-xxx="yyy"，可选
						nodeName: "工程中心",
						alias: "changyong"
					},
					children: [{
						name: '李一一',
						checkboxValue: 1
					}, {
						name: '李一一',
						checkboxValue: 2
					}, {
						name: '李一一',
						checkboxValue: 3
					}]
				}
			]
		});
	});
	
	$("#check-all").attr("checked",false);
	$("#check-all").click(function(){
		var checkall = $("#check-all").prop("checked");
		if( checkall == true ){//选中
			$("#demo").find("input").attr("checked",true);
		}
        if( checkall == false ){//未选中
            $("#demo").find("input").attr("checked",false);
        }
	})
	
	$(".check-name label").click(function(){
		strchecked()
	})
	
	function strchecked(){
		setTimeout(function(){
			var strchecked =$("#demo ul :checked").length;
			var str =$("#demo ul :checked").parent("li").find("a").find("cite").map(function(index,elem){
				return $(elem).text();
			}).get().join(",")
			$("#staff input").val(str)
			if(strchecked==0){
				$("#staff").hide();
			}else{
				$("#staff").show();
			}
		},100)
	}
	strchecked()
	
	$("#people-cancel").click(function(){
		$("#demo :checkbox").attr("checked",false)
		$("#staff input").val("")
		$("#staff").hide();
	})
</script>
</html>
