
<div class="content">
    <p class="crumbs">您当前的位置：出差管理 &gt; <a href="javascript:;">出差申请</a></p>
  
    <!--出差申请-->
    <div class="add-out ta-c">
        <form action="">
            <p class="add-nav fs-14 c-f ta-l">出差申请单</p>
            <div class="out-pick fs-12 c-9 ta-l">
                <ul class="lif-l w">
                    <div>
                    <li class="d-ib">
                        <span class="pick-span d-ib c-6">出差申请人：</span>
                        <p class="datep d-ib">李一一</p>
                    </li>
                    <li class="d-ib">
                        <span class="pick-span d-ib c-6">拟派出差人：</span>
                        <p class="d-ib" id="staff">
                            <input type="text" value="李一一" readonly class="d-n">
                            <span class="d-ib c-9 ta-c">李一一</span>
                        </p>
                        <a href="#" class="traveller add-to d-ib ta-c">添加</a>
                        <img src="img/icon19.png" alt="" class="asterisk">
                    </li>
                    </div>
                    <li class="d-ib">
                        <span class="pick-span d-ib c-6">出差地点：</span>
                        <div class="d-ib" data-toggle="distpicker">
                            <select class="js-select100 select-normal" id="province1"></select>
                            <select class="js-select100 select-normal" id="city1"></select>
                            <select class="js-select100 select-normal" id="district1"></select>
                            <div class="c-b"></div>
                        </div>
                    </li>
                    <li class="d-ib Sale">
                        <span class="pick-span d-ib c-6">所属销售：</span>
                        <select class="js-A1-slt1 select-normal" name="worktype" id="province">
                            <option>请选择</option>
                            <option>请选择</option>
                        </select>
                        <select class="js-A1-slt1 select-normal city" name="worktype1">
                            <option>请选择</option>
                            <option>请选择</option>
                        </select>
                        <img src="img/icon19.png" alt="" class="asterisk">
                    </li>
                    <li class="d-ib">
                        <span class="pick-span d-ib c-6">所属项目：</span>
                        <select class="js-select200 select-normal" name="branch">
                            <option>PC软件部</option>
                            <option>请选择</option>
                        </select>
                    </li>
                    <li class="d-ib"></li>
                    <li class="d-ib">
                        <span class="pick-span d-ib c-6">所用产品：</span>
                        <input type="text" value="自动选择" readonly>
                    </li>
                    <li class="d-ib">
                        <span class="pick-span d-ib c-6">客户名称：</span>
                        <input type="text" value="自动选择" readonly>
                    </li>
                    <li class="d-ib">
                        <span class="pick-span d-ib c-6">联系人：</span>
                        <select class="js-select200 select-normal" name="branch">
                            <option>小张</option>
                            <option>请选择</option>
                        </select>
                        <img src="img/icon19.png" alt="" class="asterisk">
                    </li>
                    <li class="d-ib">
                        <span class="pick-span d-ib c-6">联系方式：</span>
                        <input type="text" value="联系方式">
                        <img src="img/icon19.png" alt="" class="asterisk">
                    </li>
                    <li class="d-ib">
                        <span class="pick-span d-ib c-6">电子邮箱：</span>
                        <input type="text" value="电子邮箱">
                    </li>
                    <li class="d-ib">
                        <span class="pick-span d-ib c-6">QQ/MSN号：</span>
                        <input type="text" value="QQ/MSN号">
                    </li>
                    <li class="d-ib">
                        <span class="pick-span d-ib c-6">预计开始时间：</span>
                        <input id="inpstart" name="time1" type="text" value="" placeholder="请选择"  readonly>
                        <img src="img/icon19.png" alt="" class="asterisk">
                    </li>
                    <li class="d-ib">
                        <span class="pick-span d-ib c-6">预计结束时间：</span>
                        <input id="inpend" name="time2" type="text" value="" placeholder="请选择"  readonly>
                        <img src="img/icon19.png" alt="" class="asterisk">
                    </li>
                    <div class="c-b"></div>
                </ul>
                <div class="out-bottom">
                    <span class="d-ib c-6 bottom-span">出差事由及 <br /> 解决问题:</span>
                    <textarea>请选择请选择请选择请选择请选择请选择请选择请选择请选择请选择请选择请选择请选择请选择请选择择请选择请选择请选择</textarea>
                </div>
                <div class="out-bottom">
                    <span class="d-ib c-6 bottom-span">交通工具:</span>
                    <select class="js-select150 select-normal" name="branch">
                        <option>飞机</option>
                        <option>火车</option>
                    </select>
                </div>
                <div class="out-bottom">
                    <span class="d-ib c-6 bottom-span">差旅费报销方式:</span>
                    <div class="reimbursement d-ib">
                        <p>
                            <span class="d-ib">我司全额支付</span>
                            <input name="Fruit" type="radio" value="" checked="checked"/>
                        </p>
                        <p>	
                            <span class="d-ib">我方先垫付，客户支付</span>
                            <input name="Fruit" type="radio" value="" />
                            (
                            <label class="check-box">
                                <input name="Fruit" type="checkbox" value="" />
                                <i class="d-ib"></i>
                                单程车票
                            </label> 
                            <label class="check-box">
                                <input name="Fruit" type="checkbox" value="" />
                                <i class="d-ib"></i>
                                往返车票
                            </label>
                            <label class="check-box">
                                <input name="Fruit" type="checkbox" value="" />
                                <i class="d-ib"></i>
                                住宿费
                            </label> 
                            <label class="check-box">
                                <input name="Fruit" type="checkbox" value="" />
                                <i class="d-ib"></i>
                                出差饭费
                            </label> 
                            <label class="check-box">
                                <input name="Fruit" type="checkbox" value="" />
                                <i class="d-ib"></i>
                                市内交通费
                            </label> 
                            )
                        </p>
                        <p>
                            <span class="d-ib">无需垫付，客户提供</span>
                            <input name="Fruit" type="radio" value="" />
                            (
                            <label class="check-box">
                                <input name="Fruit" type="checkbox" value="" />
                                <i class="d-ib"></i>
                                单程车票
                            </label> 
                            <label class="check-box">
                                <input name="Fruit" type="checkbox" value="" />
                                <i class="d-ib"></i>
                                往返车票
                            </label>
                            <label class="check-box">
                                <input name="Fruit" type="checkbox" value="" />
                                <i class="d-ib"></i>
                                住宿费
                            </label> 
                            <label class="check-box">
                                <input name="Fruit" type="checkbox" value="" />
                                <i class="d-ib"></i>
                                出差饭费
                            </label> 
                            <label class="check-box">
                                <input name="Fruit" type="checkbox" value="" />
                                <i class="d-ib"></i>
                                市内交通费
                            </label> 
                            )
                        </p>
                        <p>
                            <span class="d-ib">客户统一向公司支付每人每日</span>
                            <input name="Fruit" type="radio" value="" />
                            <input type="text" value="100">元人员安装费
                        </p>
                    </div>
                </div>
            </div>
            
            <div>
                <a href="javascript:;" class="add-submit d-ib ta-c fs-14">重置</a>
                <a href="javascript:;" class="add-submit d-ib ta-c fs-14">提交</a>
            </div>
        </form>
    </div>
</div>
	
    <!--添加出差人-->
    <div class="mask p-f d-n"></div>
    <div class="out-people bg-f p-f d-n" id="out-people">
    	<h5 class="fs-14 c-f ta-c">添加出差人</h5>
        <div class="check-name">
        	<span class="f-l">人员菜单：</span>
            <span class="f-r">全选</span>
            <input type="checkbox" class="f-r checkall d-n" id="check-all">
            <label for="check-all" class="f-r"></label>
            <div class="c-b"></div>
        </div>
        <ul id="demo"></ul>
        <div class="opt ta-c fs-14 ta-c">
        	<a href="javascript:;" class="cancel d-ib" id="people-cancel">取消</a>
            <a href="javascript:;" class="keep d-ib" id="people-keep">保存</a>
        </div>
    </div>
    
    <!--添加联系人信息弹窗-->
    <div class="information bg-f p-f o-h d-n">
    	<h5 class="fs-14 c-f ta-c">添加联系人信息</h5>
        <div class="information-box ta-l">
        	<div class="d-ib f-l">
                <span class="d-ib fs-12 c-6">客户联系人</span>
                <input type="text" name="created-date" value="小小陈">
            </div>
            <div class="d-ib f-l">
                <span class="d-ib fs-12 c-6">职位</span>
                <input type="text" name="created-date" value="项目经理">
            </div>
            <div class="d-ib f-l">
                <span class="d-ib fs-12 c-6">职责</span>
                <input type="text" name="created-date" value="项目经理">
            </div>
            <div class="d-ib f-l">
                <span class="d-ib fs-12 c-6">手机号</span>
                <input type="text" name="created-date" value="15126468975">
            </div>
            <div class="d-ib f-l">
                <span class="d-ib fs-12 c-6">邮箱</span>
                <input type="text" name="created-date" value="761115495@qq.com">
            </div>
            <div class="d-ib f-l">
                <span class="d-ib fs-12 c-6">座机</span>
                <input type="text" name="created-date" value="3326546">
            </div>
            <p class="c-b"></p>
        </div>
        <div class="information-a ta-c fa-14">
        	<a href="javascript:;" class="cancel d-ib">取消</a>
            <a href="javascript:;" class="confirm d-ib">保存</a>
        </div>
    </div>

<script src="js/select2_option.js"></script>
<script src="js/jquery.jedate.js"></script>
<script src="js/distpicker.data.js"></script>
<script src="js/distpicker.js"></script>
<script src="js/main.js"></script>
<script>
	
    $(".cancel,.keep").click(function(){
        $(".mask,#out-people").hide();
    })
    $(".traveller").click(function(){
        $(".mask,#out-people").show();
    })

    //差旅费报销方式
	$(".reimbursement p :radio:checked").parent("p").find("span").addClass("active");
	$(".check-box").find(":checkbox:checked").next("i").addClass("i-active");
	$(".reimbursement p").click(function(){
		$(".reimbursement p span").removeClass("active");
		$(this).find("span").addClass("active");
		$(this).find(":radio").attr("checked",true);
		$(".reimbursement p").not(this).find(":checkbox").attr("checked",false);
        $(".check-box").find("i").removeClass("i-active");
        $(".check-box").find(":checkbox:checked").next("i").addClass("i-active");
	})

	
	//实现日期选择联动
	var start = {
		format: 'YYYY-MM-DD',
		choosefun: function(elem,datas){
			end.minDate = datas; //开始日选好后，重置结束日的最小日期
			endDates();
		}
	};
	var end = {
		format: 'YYYY-MM-DD',
		choosefun: function(elem,datas){
			start.maxDate = datas; //将结束日的初始值设定为开始日的最大日期
		}
	};
	function endDates() {
		end.trigger = false;
		$("#inpend").jeDate(end);
	}
	$("#inpstart").jeDate(start);
	$("#inpend").jeDate(end);

	
	//添加出差人
	$(".cancel,.confirm").click(function(){
		$(".mask,.information,.out-people").hide();
	})
	
</script>
<script>
	layui.use('tree', function() {
		var tree = layui.tree({
			elem: '#demo', //指定元素，生成的树放到哪个元素上
			check: 'checkbox', //勾选风格
			skin: 'as', //设定皮肤
			drag: true,//点击每一项时是否生成提示信息
			checkboxName: 'aa[]',//复选框的name属性值
			checkboxStyle: "",//设置复选框的样式，必须为字符串
			onchange: function (){//当当前input发生变化后所执行的回调
				var strchecked =$("#demo ul :checked").length;
				var str =$("#demo ul :checked").parent("li").find("a").find("cite").map(function(index,elem){
						return $(elem).text();
					}).get().join(",")
				$("#staff input").val(str);
				$("#staff span").text(str);
				$("#staff").show();
				if(strchecked ==0){
					$("#staff").hide();
				}
			},
			nodes: [ //节点
				{
					name: '工程中心', //节点名称
					checkboxValue: 0,//复选框的值
					data: {//为元素添加额外数据，即在元素上添加data-xxx="yyy"，可选
						nodeName: "工程中心",
						alias: "changyong"
					},
					children: [{
						name: '李一1',
						checkboxValue: 1
					}, {
						name: '李一2',
						checkboxValue: 2
					}, {
						name: '李一3',
						checkboxValue: 3
					}]
				},{
					name: '产品中心', //节点名称
					checkboxValue: 0,//复选框的值
					data: {//为元素添加额外数据，即在元素上添加data-xxx="yyy"，可选
						nodeName: "工程中心",
						alias: "changyong"
					},
					children: [{
						name: '李一4',
						checkboxValue: 1
					}, {
						name: '李一5',
						checkboxValue: 2
					}, {
						name: '李一6',
						checkboxValue: 3
					}]
				},{
					name: '工程中心', //节点名称
					checkboxValue: 0,//复选框的值
					data: {//为元素添加额外数据，即在元素上添加data-xxx="yyy"，可选
						nodeName: "工程中心",
						alias: "changyong"
					},
					children: [{
						name: '李一7',
						checkboxValue: 1
					}, {
						name: '李一8',
						checkboxValue: 2
					}, {
						name: '李一9',
						checkboxValue: 3
					}]
				},{
					name: '产品中心', //节点名称
					checkboxValue: 0,//复选框的值
					data: {//为元素添加额外数据，即在元素上添加data-xxx="yyy"，可选
						nodeName: "工程中心",
						alias: "changyong"
					},
					children: [{
						name: '李一10',
						checkboxValue: 1
					}, {
						name: '李一11',
						checkboxValue: 2
					}, {
						name: '李一12',
						checkboxValue: 3
					}]
				},{
					name: '工程中心', //节点名称
					checkboxValue: 0,//复选框的值
					data: {//为元素添加额外数据，即在元素上添加data-xxx="yyy"，可选
						nodeName: "工程中心",
						alias: "changyong"
					},
					children: [{
						name: '李一13',
						checkboxValue: 1
					}, {
						name: '李一14',
						checkboxValue: 2
					}, {
						name: '李一15',
						checkboxValue: 3
					}]
				},{
					name: '产品中心', //节点名称
					checkboxValue: 0,//复选框的值
					spread: true, //是否是展开状态，true为展开状态
					checked: true,//复选框默认是否选中	
					data: {//为元素添加额外数据，即在元素上添加data-xxx="yyy"，可选
						nodeName: "工程中心",
						alias: "changyong"
					},
					children: [{
						name: '李一一',
						checkboxValue: 1
					}, {
						name: '李一二',
						checkboxValue: 2,
						checked: true  //复选框默认是否选中
					}, {
						name: '李一三',
						checkboxValue: 3
					}]
				},{
					name: '工程中心', //节点名称
					checkboxValue: 0,//复选框的值
					data: {//为元素添加额外数据，即在元素上添加data-xxx="yyy"，可选
						nodeName: "工程中心",
						alias: "changyong"
					},
					children: [{
						name: '李一一',
						checkboxValue: 1
					}, {
						name: '李一一',
						checkboxValue: 2
					}, {
						name: '李一一',
						checkboxValue: 3
					}]
				},{
					name: '产品中心', //节点名称
					checkboxValue: 0,//复选框的值
					data: {//为元素添加额外数据，即在元素上添加data-xxx="yyy"，可选
						nodeName: "工程中心",
						alias: "changyong"
					},
					children: [{
						name: '李一一',
						checkboxValue: 1
					}, {
						name: '李一一',
						checkboxValue: 2
					}, {
						name: '李一一',
						checkboxValue: 3
					}]
				}
			]
		});
	});

    $("#check-all").attr("checked",false);
	$("#check-all").click(function(){
		var checkall = $("#check-all").prop("checked");
		if( checkall == true ){//选中
			$("#demo").find("input").attr("checked",true);
		}
        if( checkall == false ){//未选中
            $("#demo").find("input").attr("checked",false);
        }
	})
	
	$(".check-name label").click(function(){
		strchecked()
	})
	
	function strchecked(){
		setTimeout(function(){
			var strchecked =$("#demo ul :checked").length;
			var str =$("#demo ul :checked").parent("li").find("a").find("cite").map(function(index,elem){
				return $(elem).text();
			}).get().join(",")
			$("#staff input").val(str)
			$("#staff span").text(str)
			if(strchecked==0){
				$("#staff").hide();
			}else{
				$("#staff").show();
			}
		},100)
	}
	strchecked()
	
	$("#people-cancel").click(function(){
		$("#demo :checkbox").attr("checked",false)
		$("#staff input").val("")
		$("#staff").hide();
	})
	
</script>
